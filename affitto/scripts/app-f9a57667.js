!function(){"use strict";angular.module("app.core",["ui.router","firebase","ngAnimate"])}(),function(){"use strict";function t(){}angular.module("app.core").run(t)}(),function(){"use strict";function t(t,a){a.otherwise("/"),t.state("aff",{url:"/",templateUrl:"app/layout/shell.html",controller:"Shell as vm"})}angular.module("app.core").config(t),t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("app.core").constant("API","https://scorching-heat-2725.firebaseio.com/affitto").constant("PRECISION",2)}(),function(){"use strict";angular.module("app.widgets",[])}(),function(){"use strict";angular.module("app.table",[])}(),function(){"use strict";function t(t,a){function e(){n.data.forEach(function(t){t.total=a.calculateTotal(t.values)})}var n=this;n.data=t,e()}angular.module("app.table").controller("Table",t),t.$inject=["data","calcService"]}(),function(){"use strict";function t(t){t.state("aff.table",{url:"table",views:{content:{templateUrl:"app/table/table.html",controller:"Table as vm"}},resolve:{data:["dataService","$q",function(t,a){var e=a.defer();return t.get().then(e.resolve),e.promise}]}})}angular.module("app.table").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";angular.module("app.layout",[])}(),function(){"use strict";function t(){function t(){}t()}angular.module("app.layout").controller("Shell",t)}(),function(){"use strict";angular.module("app.graph",["chart.js"])}(),function(){"use strict";function t(t,a,e,n){function o(){}function r(){4===f.lineData.length?f.totalData=f.lineData.pop():f.lineData.push(f.totalData)}function l(){f.type="line"===f.type?"pie":"line"}function i(o){return"total"===o?t.map(function(t){return a.calculateTotal(t.values)}):n.chain(t).pluck("values").map(function(t){return n.filter(t,{type:o})[0]}).map(function(t){return(t.amount*t.price).toFixed(e)}).value()}function c(){return[i("hotWater"),i("coldWater"),i("electricity"),i("total")]}function s(){var t=function(t,a){return t+parseFloat(a)};return[i("hotWater").reduce(t,0).toFixed(e),i("coldWater").reduce(t,0).toFixed(e),i("electricity").reduce(t,0).toFixed(e)]}function u(){return t.map(function(t){return[t.month,t.year].join(", ")})}function d(){return["Hot Water","Cold Water","Electricity","Total"]}var f=this;f.type="line",f.toggle=l,f.toggleTotal=r,f.lineData=c(t),f.lineSeries=d(t),f.lineLabels=u(t),f.pieData=s(t),f.pieLabels=["Hot Water","Cold Water","Electricity"],o()}angular.module("app.graph").controller("Graph",t),t.$inject=["data","calcService","PRECISION","_"]}(),function(){"use strict";function t(t){t.state("aff.graph",{url:"graph",views:{content:{templateUrl:"app/graph/graph.html",controller:"Graph as vm"}},resolve:{data:["dataService","$q",function(t,a){var e=a.defer();return t.get().then(e.resolve),e.promise}]}})}angular.module("app.graph").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t){t.setOptions({colours:["#F7464A","#97BBCD","#FDB45C","#46BFBD","#DCDCDC","#949FB1","#4D5360"]})}angular.module("app.graph").config(t),t.$inject=["ChartJsProvider"]}(),function(){"use strict";angular.module("app.form",[])}(),function(){"use strict";function t(){function t(){return[2014,2015,2016,2017]}function a(){return["January","February","March","April","May","June","July","August","September","October","November","December"]}function e(t){return t.reduce(function(t,a){return t+parseFloat(a.price,10)*parseFloat(a.amount,10)},0).toFixed(2)}var n={getYears:t,getMonths:a,getTotal:e};return n}angular.module("app.form").factory("formService",t)}(),function(){"use strict";function t(t,a,e,n){function o(){}function r(){return n.getTotal(i.item.values)}function l(){function e(){t.go("aff.table")}function n(){}i.item.year&&i.item.month&&a.save(i.item).then(e,n)}var i=this;i.save=l,i.getTotal=r,i.years=n.getYears(),i.months=n.getMonths(),i.item=e,o()}angular.module("app.form").controller("FormEdit",t),t.$inject=["$state","dataService","item","formService"]}(),function(){"use strict";function t(t,a,e,n){function o(){}function r(){return e.getTotal(i.item.values)}function l(){function e(){t.go("aff.table")}function n(){}i.item.year&&i.item.month&&a.add(i.item).then(e,n)}var i=this,c=new Date;i.save=l,i.getTotal=r,i.years=e.getYears(),i.months=e.getMonths(),i.item={year:c.getFullYear(),month:i.months[c.getMonth()]},i.item.values=[{type:"electricity",price:n.electricity},{type:"coldWater",price:n.coldWater},{type:"hotWater",price:n.hotWater}],o()}angular.module("app.form").controller("FormAdd",t),t.$inject=["$state","dataService","formService","last"]}(),function(){"use strict";function t(t){t.state("aff.add",{url:"form",views:{content:{templateUrl:"app/form/form.html",controller:"FormAdd as vm"}},resolve:{last:["dataService",function(t){return t.getLast()}]}}).state("aff.edit",{url:"form/:id",views:{content:{templateUrl:"app/form/form.html",controller:"FormEdit as vm"}},resolve:{item:["dataService","$stateParams",function(t,a){return t.getRecord(a.id)}]}})}angular.module("app.form").config(t),t.$inject=["$stateProvider"]}(),function(){"use strict";function t(t){var a=t._;if(!a)throw new Error("Error! No lodash!");return a}angular.module("app.core").factory("_",t),t.$inject=["$window"]}(),function(){"use strict";function t(t,a,e,n,o){function r(t){return f.$loaded().then(function(){return f.$getRecord(t)})}function l(t){return f.$add(t)}function i(t){return f.$remove(t)}function c(t){return f.$save(t)}function s(){return f.$loaded()}function u(){function a(t){return t.values.reduce(function(t,a){return t[a.type]=a.price,t},{})}var e=o.defer();return t(d.limitToLast(1)).$loaded().then(function(t){e.resolve(a(t[0]))}),e.promise}var d=new n.Firebase(e),f=t(d),p={get:s,add:l,save:c,remove:i,getRecord:r,getLast:u};return p}angular.module("app.core").factory("dataService",t),t.$inject=["$firebaseArray","$firebaseObject","API","$window","$q"]}(),function(){"use strict";function t(t){function a(a){return a.reduce(function(t,a){return t+a.amount*a.price},0).toFixed(t)}var e={calculateTotal:a};return e}angular.module("app.core").factory("calcService",t),t.$inject=["PRECISION"]}(),function(){"use strict";function t(t,e,n,o){n.decorator("$exceptionHandler",a),t.debugInfoEnabled(!1),e.debugEnabled(!1),o.classNameFilter(/animated/)}function a(t){return t=function(){}}angular.module("production",[]).config(t),t.$inject=["$compileProvider","$logProvider","$provide","$animateProvider"],a.$inject=["$delegate"]}(),function(){"use strict";angular.module("app",["production","app.core","app.widgets","app.layout","app.graph","app.table","app.form"])}(),angular.module("app").run(["$templateCache",function(t){t.put("app/form/form.html",'<div class="aff-form-wrap"><form class="form-horizontal"><div class="form-group"><label class="col-xs-2 control-label">Year</label><div class="col-xs-10"><select ng-model="vm.item.year" ng-options="year for year in vm.years" class="form-control"></select></div></div><div class="form-group"><label class="col-xs-2 control-label">Month</label><div class="col-xs-10"><select ng-model="vm.item.month" ng-options="month for month in vm.months" class="form-control"></select></div></div><div class="form-group"><label class="col-xs-2 form-control-static aff-yellow">Electricity</label><div class="col-sm-5 col-xs-10"><div class="input-group"><div class="input-group-addon"><i class="icon-lightbulb aff-yellow"></i></div><input placeholder="Amount" ng-model="vm.item.values[0].amount" class="form-control"></div></div><div class="col-xs-offset-2 col-sm-offset-0 col-sm-5 col-xs-10 aff-form-last"><div class="input-group"><input placeholder="Price" ng-model="vm.item.values[0].price" class="form-control"><div class="input-group-addon aff-yellow">UAH</div></div></div></div><div class="form-group"><label class="col-xs-2 form-control-static aff-blue">Cold Water</label><div class="col-sm-5 col-xs-10"><div class="input-group"><div class="input-group-addon"><i class="icon-water aff-blue"></i></div><input placeholder="Amount" ng-model="vm.item.values[1].amount" class="form-control"></div></div><div class="col-xs-offset-2 col-sm-offset-0 col-sm-5 col-xs-10 aff-form-last"><div class="input-group"><input placeholder="Price" ng-model="vm.item.values[1].price" class="form-control"><div class="input-group-addon aff-blue">UAH</div></div></div></div><div class="form-group"><label class="col-xs-2 form-control-static aff-red">Hot Water</label><div class="col-sm-5 col-xs-10"><div class="input-group"><div class="input-group-addon"><i class="icon-water aff-red"></i></div><input placeholder="Amount" ng-model="vm.item.values[2].amount" class="form-control"></div></div><div class="col-xs-offset-2 col-sm-offset-0 col-sm-5 col-xs-10 aff-form-last"><div class="input-group"><input placeholder="Price" ng-model="vm.item.values[2].price" class="form-control"><div class="input-group-addon aff-red">UAH</div></div></div></div><div class="form-group"><div class="col-xs-offset-2 col-sm-offset-2 col-sm-10 col-xs-10"><div class="bg-success total-line"><div class="total-title">Total:</div><div ng-bind="vm.getTotal()" class="total-value"></div></div></div></div><div class="btn-group pull-right"><button type="button" ng-click="vm.save()" class="btn btn-success"><span class="icon-glyph"></span></button> <button type="button" ui-sref="aff.table" class="btn btn-danger"><span class="icon-glyph-1"></span></button></div><div class="clearfix"></div></form></div>'),t.put("app/graph/graph.html",'<div class="aff-graph-wrap"><div ng-show="vm.type==\'line\'"><div class="well">over time</div><canvas data="vm.lineData" labels="vm.lineLabels" series="vm.lineSeries" legend="true" class="chart chart-line"></canvas></div><div ng-show="vm.type==\'pie\'"><div class="well">total</div><canvas data="vm.pieData" labels="vm.pieLabels" legend="true" class="chart chart-pie"></canvas></div><div class="text-center"><button type="button" ng-click="vm.toggle()" class="btn btn-info"><span class="icon-arrows-cw"></span></button></div><div class="text-center"><button type="button" ng-click="vm.toggleTotal()" ng-if="vm.type == \'line\'" class="btn btn-info">show total</button></div></div>'),t.put("app/layout/footer.html",'<span class="aff-copyright">&copy; 2015 Affitto</span>'),t.put("app/layout/shell.html",'<div class="aff-header"><div ng-include="\'app/layout/topnav.html\'" class="container"></div></div><div class="aff-content"><div ui-view="content" class="animated container"></div></div><div class="aff-footer"><div ng-include="\'app/layout/footer.html\'" class="container"></div></div>'),t.put("app/layout/topnav.html",'<nav role="navigation" class="navbar navbar-inverse"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#aff-navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><div class="icon-bar"></div><div class="icon-bar"></div><div class="icon-bar"></div></button><a ui-sref="aff" class="navbar-brand">Affitto</a></div><div id="aff-navbar" class="collapse navbar-collapse"><ul class="nav navbar-nav navbar-right"><li ui-sref-active="active"><a ui-sref="aff.table" title="Table">Table</a></li><li ui-sref-active="active"><a ui-sref="aff.graph" title="Graph">Graph</a></li></ul></div></nav>'),t.put("app/table/table.html",'<div class="aff-table-wrap"><table ng-if="vm.data.length" class="table table-striped table-hover"><tr><th>ID</th><th>month</th><th>year</th><th>total</th><th></th></tr><tr ng-repeat="item in vm.data"><th><span ng-bind="$index + 1"></span></th><td><span ng-bind="item.month"></span></td><td><span ng-bind="item.year"></span></td><td><span ng-bind="item.total"></span></td><td><span ui-sref="aff.edit({id: item.$id})" class="icon-edit aff-edit"></span></td></tr></table><button type="button" ui-sref="aff.add" class="btn btn-info btn-block"><span class="icon-plus-squared"></span></button></div>')}]);